# タスク28: 仕訳入力時の税区分連動機能実装

## タスク概要
仕訳入力画面で税区分マスタと連動し、勘定科目選択時のデフォルト税区分自動設定機能を実装する

## 背景
- 現在の仕訳入力は固定の税区分選択肢を使用
- 勘定科目マスタで設定されたデフォルト税区分が反映されない
- 税区分マスタとの連動ができていない

## 実装予定内容

### サブタスク

#### 28.1 仕訳入力コンポーネントの税区分マスタ対応
- `components/accounting/journal-detail-input.tsx`の更新
- 税区分選択肢を税区分マスタから動的取得
- `taxRate`フィールドを`taxCode`に完全移行

#### 28.2 勘定科目選択時のデフォルト税区分自動設定
- 勘定科目選択時に該当する勘定科目のデフォルト税区分を取得
- フォームの税区分フィールドに自動設定
- ユーザーによる手動変更も可能

#### 28.3 仕訳入力での税区分インライン追加機能
- 勘定科目フォームと同様の「+ 新しい税区分を追加」機能
- その場で税区分コード・名称・税率を入力可能
- 追加後は即座に選択肢に反映

#### 28.4 税率計算ロジックの更新
- 選択された税区分の税率を使用した自動計算
- 税区分変更時の金額再計算

#### 28.5 既存仕訳データの移行対応
- `taxRate`から`taxCode`への移行処理
- 既存データの互換性確保

## 期待される効果
- 仕訳入力の効率化（勘定科目選択時の自動税区分設定）
- 税区分マスタの一元管理効果の最大化
- 将来的な税率変更への対応力向上

## 優先度
**Medium** - 基本的な税区分機能は完了済み、利便性向上のための機能

## 前提条件
- タスク27（税区分マスタテーブル機能実装）が完了済み
- 税区分マスタのServer Actions実装済み

## 完了条件
- 仕訳入力時に税区分マスタから選択肢が取得される
- 勘定科目選択時にデフォルト税区分が自動設定される
- 仕訳入力画面でも税区分のインライン追加が可能
- 既存機能に影響なく動作する

作成日: 2025-06-14
ステータス: pending