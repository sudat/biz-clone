# Biz Clone プロジェクト概要

## プロジェクトについて

**Biz Clone** は、現代的な技術スタックを使用して構築された**会計システム**です。  
企業の仕訳入力、勘定科目管理、取引先管理などの基本的な会計業務をデジタル化することを目的としています。

## 技術スタック

### フロントエンド

- **Next.js 15.3.3** - React 基盤のフルスタックフレームワーク
- **React 19** - ユーザーインターフェース構築
- **TypeScript** - 型安全な開発
- **Tailwind CSS** - スタイリング
- **Shadcn/UI** - UI コンポーネントライブラリ
- **Radix UI** - アクセシブルなプリミティブコンポーネント

### バックエンド・データベース

- **Supabase** - BaaS（Backend as a Service）
- **PostgreSQL** - データベース
- **Prisma** - ORM（Object-Relational Mapping）
- **Zod** - スキーマ検証

### 開発・テスト

- **Playwright** - E2E テスト
- **ESLint** - コード品質チェック
- **Bun/npm** - パッケージ管理

## プロジェクトの特徴

### 1. 会計業務のデジタル化

- 仕訳入力・管理
- 勘定科目マスタ管理
- 補助科目管理
- 取引先マスタ管理
- 分析コード管理

### 2. 現代的なアーキテクチャとは何か？

**現代的なアーキテクチャ**とは、昔のシステム開発の問題を解決するために生まれた設計手法です。

#### 昔のシステムの問題点

- **スパゲッティコード**: すべてのコードが絡み合っていて、修正すると予期せぬところでバグが発生
- **テストが困難**: コードが密結合していて、部分的なテストができない
- **機能追加が困難**: 新機能を追加するたびに既存コードを大幅に修正する必要がある

#### 現代的なアーキテクチャの解決策

**レイヤードアーキテクチャ（4 層構造）**

```
プレゼンテーション層 ← ユーザーが見る画面
     ↓
アプリケーション層 ← 業務の流れを制御
     ↓
ドメイン層 ← ビジネスルールを定義
     ↓
インフラ層 ← データベースとの接続
```

**Repository パターン**

- データベースへのアクセス方法を統一化
- 「勘定科目を取得する」という処理を、データベースの詳細を知らなくても使える

**Service 層によるビジネスロジック分離**

- 「新しい勘定科目を作成する」などの業務ロジックを独立させる
- 画面から独立しているので、API でも Web 画面でも同じロジックを使える

**型安全性**

- TypeScript により、間違ったデータ型を使うとコンパイル時にエラーになる
- 実行前にバグを発見できる

### 3. スケーラブルな設計とは何か？

**スケーラブル**とは、システムが成長しても対応できる設計のことです。

#### 具体的な成長パターンと対策

**ユーザー数の増加**

- **問題**: 1,000 人のユーザーが同時にアクセスしたらシステムが重くなる
- **対策**: キャッシュ機能、データベース最適化、サーバー増設が容易な設計

**機能の追加**

- **問題**: 新しい帳票機能を追加したいが、既存コードを壊しそう
- **対策**: モジュラー構造により、新機能を独立したモジュールとして追加

**開発チームの拡大**

- **問題**: 10 人の開発者が同じコードを同時に修正すると競合する
- **対策**: 依存性注入パターンにより、各開発者が独立した部分を担当可能

**データ量の増加**

- **問題**: 100 万件の仕訳データで検索が遅くなる
- **対策**: 効率的なデータアクセスパターン、インデックス最適化

#### 実装されている具体的な仕組み

**モジュラー構造による保守性**

```typescript
// 勘定科目サービスは独立しており、他の機能に影響しない
export class AccountService {
  // 勘定科目に関する処理のみを担当
}

// 取引先サービスも独立
export class PartnerService {
  // 取引先に関する処理のみを担当
}
```

**依存性注入パターン**

```typescript
// サービスは具体的なデータベースを知らない
class AccountService {
  constructor(private repository: IAccountRepository) {
    // インターフェースのみに依存
  }
}
```

**テスト可能な設計**

```typescript
// モックを使って単体テストが可能
const mockRepository = new MockAccountRepository();
const service = new AccountService(mockRepository);
// サービス単体でテストできる
```

### 4. 個人開発に最適化されたシンプル設計

最新のアーキテクチャでは、個人開発の効率性を重視して以下の簡素化を実現しました：

#### 3層構造による明確な責務分離

- **UI層**: Next.js 15とReact 19によるモダンなフロントエンド
- **ビジネスロジック層**: Server Actionsによる直接的なデータ操作
- **データ層**: Prismaによる型安全なデータベースアクセス

#### 統一型システム

- **改善前**: 複数のORM間での型変換が複雑
- **改善後**: Prisma型をベースとした完全統一によりメンテナンス性向上

#### 直接的なデータフロー

- **改善前**: 複数の抽象化層を経由した複雑なデータフロー
- **改善後**: UI → Server Actions → Database の明確で追跡しやすいフロー

#### 開発速度の向上

- **改善前**: 多層アーキテクチャによる実装コストの増大
- **改善後**: 必要最小限の構造による迅速な機能開発

## ディレクトリ構造の概要

```
biz-clone/
├── app/              # Next.js App Router (ページ・レイアウト・Server Actions)
│   ├── actions/      # Server Actions (データ操作)
│   ├── master/       # マスタデータ管理画面
│   └── siwake/       # 仕訳関連画面
├── components/       # 再利用可能なUIコンポーネント
│   ├── accounting/   # 会計業務特化コンポーネント
│   └── ui/           # 基本UIコンポーネント (Shadcn/UI)
├── lib/              # ユーティリティ・データベース層
│   ├── database/     # Prismaクライアント・データベースサービス
│   ├── schemas/      # Zodバリデーションスキーマ
│   └── utils/        # ユーティリティ関数
├── prisma/           # データベーススキーマ・マイグレーション
├── types/            # 統一TypeScript型定義
└── __tests__/        # テストファイル
```

**簡素化のポイント**: 複雑な抽象化層を削除し、必要最小限の構造で高い開発効率を実現

## 対象ユーザー

- **中小企業の経理担当者**
- **会計事務所**
- **個人事業主**

基本的な複式簿記の知識を持つユーザーを想定し、直感的で使いやすいインターフェースを提供します。

## なぜこのアーキテクチャを選んだのか？

### 個人開発における優先事項

1. **開発速度**: 迅速な機能実装とイテレーション → シンプルな構造
2. **メンテナンス性**: 一人で保守可能な複雑さ → 必要最小限のレイヤー
3. **型安全性**: バグの早期発見 → Prisma統一型システム
4. **学習コスト**: 新しい技術の習得負荷を最小化 → 標準的なNext.jsパターン

### 会計システムの特性への対応

1. **正確性が最重要**: 金額の計算ミス防止 → TypeScript + Zodバリデーション
2. **複雑なビジネスルール**: 複式簿記ルール → Server Actions内での集約管理
3. **長期間の運用**: データの長期保持 → Prismaによる安定したDB操作
4. **監査対応**: データ整合性の証明 → トランザクション管理の簡潔な実装

### 簡素化アーキテクチャの利点

- **直接的なデータフロー**: UI → Server Actions → Database で追跡が容易
- **統一型システム**: 型変換の複雑さを排除し、開発効率を向上
- **Next.js標準パターン**: フレームワークの思想に沿った自然な実装
- **テスト容易性**: シンプルな構造により単体テストが書きやすい

## 次のドキュメント

- [02\_アーキテクチャ設計.md](./02_アーキテクチャ設計.md) - システム全体のアーキテクチャ
- [03\_データベース設計.md](./03_データベース設計.md) - データベーススキーマの詳細
- [04\_フロントエンド構造.md](./04_フロントエンド構造.md) - UI・画面構成
- [05\_バックエンド構造.md](./05_バックエンド構造.md) - サービス・リポジトリ層
