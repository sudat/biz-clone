# é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒ

## æ¦‚è¦

Biz Clone ã®é–‹ç™ºç’°å¢ƒã¯ã€ç¾ä»£çš„ãªé–‹ç™ºãƒ„ãƒ¼ãƒ«ã¨**TaskMaster ã«ã‚ˆã‚‹ AI æ”¯æ´é–‹ç™ºæ‰‹æ³•**ã‚’æ¡ç”¨ã—ã€åŠ¹ç‡çš„ã§å“è³ªã®é«˜ã„é–‹ç™ºä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚  
**å‹å®‰å…¨æ€§**ã¨**è‡ªå‹•åŒ–**ã‚’é‡è¦–ã—ã€ç¶™ç¶šçš„ãªå“è³ªå‘ä¸Šã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

## é–‹ç™ºç’°å¢ƒæ§‹æˆ

### 1. å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢

#### åŸºæœ¬ç’°å¢ƒ

- **Node.js** 20.x ä»¥ä¸Š
- **npm** ã¾ãŸã¯ **Bun** ï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰
- **Git** ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- **PostgreSQL** 15.x ä»¥ä¸Šï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼‰

#### AI æ”¯æ´é–‹ç™ºç’°å¢ƒ

- **TaskMaster CLI** - AI æ”¯æ´ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
  ```bash
  npm install -g task-master-ai
  ```
- **Cursor IDE** - AI çµ±åˆé–‹ç™ºç’°å¢ƒï¼ˆæ¨å¥¨ï¼‰
- **MCP å¯¾å¿œã‚¨ãƒ‡ã‚£ã‚¿** - TaskMaster ã¨ã®çµ±åˆã«å¯¾å¿œ

#### æ¨å¥¨é–‹ç™ºãƒ„ãƒ¼ãƒ«

- **VS Code** - ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ï¼ˆCursor ã®ä»£æ›¿ï¼‰
- **Docker** - é–‹ç™ºç’°å¢ƒçµ±ä¸€
- **Supabase CLI** - Supabase æ“ä½œ
- **Prisma CLI** - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†

### 2. é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ­ãƒ¼ãƒ³ãƒ»åˆæœŸè¨­å®š

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd biz-clone

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install
# ã¾ãŸã¯
bun install

# ç’°å¢ƒå¤‰æ•°è¨­å®š
cp .env.example .env
# .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦å¿…è¦ãªå€¤ã‚’è¨­å®š
```

#### TaskMaster ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–

```bash
# TaskMaster ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆåˆå›ã®ã¿ï¼‰
task-master init --name="Biz Clone" --description="æ—¥æœ¬ä¼æ¥­å‘ã‘ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ "

# AI ãƒ¢ãƒ‡ãƒ«è¨­å®šï¼ˆå¯¾è©±å¼ï¼‰
task-master models --setup

# PRDè§£æã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯ç”Ÿæˆï¼ˆåˆå›ã®ã¿ï¼‰
task-master parse-prd --input='.taskmaster/docs/prd.txt' --research --num-tasks=15

# ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ç¢ºèª
task-master list
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Prisma ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ
npx prisma generate

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
npx prisma migrate dev

# ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
npx prisma db seed
```

#### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev
# ã¾ãŸã¯
bun dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹
```

## TaskMaster çµ±åˆé–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### 1. é–‹ç™ºã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ‰‹é †

#### Step 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³ç¢ºèª

```bash
# ç¾åœ¨ã®ã‚¿ã‚¹ã‚¯çŠ¶æ³ã‚’ç¢ºèª
task-master list

# æ¬¡ã«ä½œæ¥­ã™ã¹ãã‚¿ã‚¹ã‚¯ã‚’ç¢ºèª
task-master next
```

#### Step 2: ä½œæ¥­å¯¾è±¡ã‚¿ã‚¹ã‚¯ã®åˆ†æ

```bash
# ã‚¿ã‚¹ã‚¯ã®è©³ç´°è¡¨ç¤º
task-master show <task-id>

# è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã®å ´åˆã¯åˆ†è§£
task-master expand --id=<task-id> --research --force
```

#### Step 3: å®Ÿè£…ä½œæ¥­

```bash
# ã‚¿ã‚¹ã‚¯ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ä½œæ¥­ä¸­ã«å¤‰æ›´
task-master set-status --id=<task-id> --status=in-progress

# ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã®å®Ÿè£…éç¨‹ã‚’è¨˜éŒ²ï¼ˆæ¨å¥¨ï¼‰
task-master update-subtask --id=<subtask-id> --prompt="å®Ÿè£…é–‹å§‹
- èª¿æŸ»ã—ãŸå†…å®¹...
- å®Ÿè£…æ–¹é‡..."
```

#### Step 4: å®Œäº†å‡¦ç†

```bash
# å®Ÿè£…å®Œäº†æ™‚ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
task-master set-status --id=<task-id> --status=done

# å®Ÿè£…ã«ã‚ˆã‚Šå½±éŸ¿ã‚’å—ã‘ã‚‹å°†æ¥ã‚¿ã‚¹ã‚¯ã®æ›´æ–°
task-master update --from=<next-task-id> --prompt="å®Ÿè£…å¤‰æ›´ã®å½±éŸ¿..."
```

### 2. AI æ”¯æ´æ©Ÿèƒ½ã®æ´»ç”¨

#### è¤‡é›‘åº¦åˆ†æ

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®è¤‡é›‘åº¦åˆ†æ
task-master analyze-complexity --research --threshold=6

# åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ç¢ºèª
task-master complexity-report
```

#### ç ”ç©¶æ”¯æ´æ©Ÿèƒ½

```bash
# æœ€æ–°æŠ€è¡“æƒ…å ±ã«ã‚ˆã‚‹æ”¯æ´ã‚’æœ‰åŠ¹åŒ–
task-master expand --id=<task-id> --research
task-master add-task --prompt="æ–°æ©Ÿèƒ½è¦ä»¶..." --research
task-master update-task --id=<task-id> --prompt="å¤‰æ›´å†…å®¹..." --research
```

#### ä¸€æ‹¬å‡¦ç†

```bash
# å…¨ã¦ã®æœªåˆ†è§£ã‚¿ã‚¹ã‚¯ã‚’ä¸€æ‹¬åˆ†è§£
task-master expand --all --research --force

# ä¾å­˜é–¢ä¿‚ã®æ¤œè¨¼ãƒ»ä¿®æ­£
task-master validate-dependencies
task-master fix-dependencies
```

## ç’°å¢ƒå¤‰æ•°è¨­å®š

### 1. å¿…é ˆç’°å¢ƒå¤‰æ•°

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š

```bash
# .env ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®šä¾‹
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
DATABASE_URL="postgresql://user:password@localhost:5432/biz_clone_dev"
DIRECT_URL="postgresql://user:password@localhost:5432/biz_clone_dev"

# Supabaseè¨­å®š
NEXT_PUBLIC_SUPABASE_URL="your-supabase-url"
NEXT_PUBLIC_SUPABASE_ANON_KEY="your-supabase-anon-key"
SUPABASE_SERVICE_ROLE_KEY="your-service-role-key"

# èªè¨¼è¨­å®š
NEXTAUTH_SECRET="your-secret-key"
NEXTAUTH_URL="http://localhost:3000"
```

#### TaskMaster AI è¨­å®š

```bash
# TaskMaster AI API ã‚­ãƒ¼ï¼ˆä½¿ç”¨ã™ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ã«å¿œã˜ã¦è¨­å®šï¼‰
ANTHROPIC_API_KEY="your-anthropic-key"
OPENAI_API_KEY="your-openai-key"
PERPLEXITY_API_KEY="your-perplexity-key"
GOOGLE_API_KEY="your-google-key"

# ãã®ä»–ã®AIãƒ—ãƒ­ãƒã‚¤ãƒ€ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
MISTRAL_API_KEY="your-mistral-key"
XAI_API_KEY="your-xai-key"
OPENROUTER_API_KEY="your-openrouter-key"

# Azure OpenAIï¼ˆä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
AZURE_OPENAI_API_KEY="your-azure-key"
AZURE_OPENAI_ENDPOINT="https://your-resource.openai.azure.com"

# Ollamaï¼ˆãƒ­ãƒ¼ã‚«ãƒ«LLMä½¿ç”¨æ™‚ï¼‰
OLLAMA_BASE_URL="http://localhost:11434/api"
```

**æ³¨æ„**: TaskMaster ã®è¨­å®šï¼ˆãƒ¢ãƒ‡ãƒ«é¸æŠã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç­‰ï¼‰ã¯`.taskmaster/config.json`ã§ç®¡ç†ã•ã‚Œã€`task-master models`ã‚³ãƒãƒ³ãƒ‰ã§è¨­å®šã—ã¾ã™ã€‚ç’°å¢ƒå¤‰æ•°ã¯ API ã‚­ãƒ¼ã®ã¿ã«ä½¿ç”¨ã—ã¾ã™ã€‚

### 2. é–‹ç™ºç’°å¢ƒåˆ¥è¨­å®š

#### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

```bash
NODE_ENV=development
DEBUG=true
LOG_LEVEL=debug
TASKMASTER_LOG_LEVEL=debug
```

#### ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ

```bash
NODE_ENV=staging
DEBUG=false
LOG_LEVEL=info
TASKMASTER_LOG_LEVEL=info
```

#### æœ¬ç•ªç’°å¢ƒ

```bash
NODE_ENV=production
DEBUG=false
LOG_LEVEL=error
TASKMASTER_LOG_LEVEL=warn
```

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### 1. ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰

```mermaid
graph TD
    E2E[E2E Tests<br/>Playwright<br/>TaskMasterçµ±åˆãƒ†ã‚¹ãƒˆ]
    INT[Integration Tests<br/>APIãƒ»DBé€£æº<br/>TaskMaster API ãƒ†ã‚¹ãƒˆ]
    UNIT[Unit Tests<br/>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯<br/>TaskMaster ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£]

    style E2E fill:#ffeb3b,color:#000
    style INT fill:#4caf50,color:#fff
    style UNIT fill:#2196f3,color:#fff

    E2E --> INT
    INT --> UNIT
```

### 2. ãƒ†ã‚¹ãƒˆã®ç¨®é¡ã¨è²¬å‹™

#### Unit Testsï¼ˆå˜ä½“ãƒ†ã‚¹ãƒˆï¼‰

**å ´æ‰€**: `__tests__/unit/`  
**å¯¾è±¡**: Service ã‚¯ãƒ©ã‚¹ã€Utility é–¢æ•°ã€TaskMaster çµ±åˆé–¢æ•°
**ãƒ„ãƒ¼ãƒ«**: Jest, Testing Library

```typescript
// __tests__/unit/services/AccountService.test.ts
describe("AccountService", () => {
  let accountService: AccountService;
  let mockRepository: jest.Mocked<IAccountRepository>;

  beforeEach(() => {
    mockRepository = {
      findById: jest.fn(),
      create: jest.fn(),
      // ...
    } as jest.Mocked<IAccountRepository>;

    accountService = new AccountService(mockRepository);
  });

  describe("createAccount", () => {
    it("æ­£å¸¸ãªå‹˜å®šç§‘ç›®ãƒ‡ãƒ¼ã‚¿ã§ä½œæˆã§ãã‚‹ã“ã¨", async () => {
      const accountData: AccountCreateDto = {
        accountCode: "TEST001",
        accountName: "ãƒ†ã‚¹ãƒˆå‹˜å®šç§‘ç›®",
        accountType: "è³‡ç”£",
        isDetail: true,
        isActive: true,
        sortOrder: 1,
      };

      mockRepository.create.mockResolvedValue({
        ...accountData,
        createdAt: new Date(),
        updatedAt: new Date(),
      } as Account);

      const result = await accountService.createAccount(accountData);

      expect(mockRepository.create).toHaveBeenCalledWith(accountData);
      expect(result.accountCode).toBe("TEST001");
    });

    it("ç„¡åŠ¹ãªå‹˜å®šç§‘ç›®ã‚³ãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨", async () => {
      const invalidData: AccountCreateDto = {
        accountCode: "invalid-code",
        accountName: "ãƒ†ã‚¹ãƒˆ",
        accountType: "è³‡ç”£",
        isDetail: true,
        isActive: true,
        sortOrder: 1,
      };

      await expect(accountService.createAccount(invalidData)).rejects.toThrow(
        "å‹˜å®šç§‘ç›®ã‚³ãƒ¼ãƒ‰ã¯3-10æ–‡å­—ã®è‹±æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„"
      );
    });
  });
});
```

#### TaskMaster çµ±åˆãƒ†ã‚¹ãƒˆ

```typescript
// __tests__/unit/taskmaster/TaskmasterIntegration.test.ts
describe("TaskMaster Integration", () => {
  describe("ã‚¿ã‚¹ã‚¯ç®¡ç†æ©Ÿèƒ½", () => {
    it("ã‚¿ã‚¹ã‚¯ã®ä½œæˆã‹ã‚‰å®Œäº†ã¾ã§æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨", async () => {
      // TaskMasterã®ãƒ¢ãƒƒã‚¯è¨­å®š
      const mockTaskmaster = new MockTaskmaster();

      // ã‚¿ã‚¹ã‚¯ä½œæˆ
      const taskId = await mockTaskmaster.addTask({
        prompt: "å‹˜å®šç§‘ç›®ä½œæˆæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆå®Ÿè£…",
        priority: "high",
      });

      expect(taskId).toBeDefined();

      // ã‚¿ã‚¹ã‚¯ã®è©³ç´°ç¢ºèª
      const task = await mockTaskmaster.getTask(taskId);
      expect(task.status).toBe("pending");

      // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
      await mockTaskmaster.setTaskStatus(taskId, "done");

      const updatedTask = await mockTaskmaster.getTask(taskId);
      expect(updatedTask.status).toBe("done");
    });
  });
});
```

#### Integration Testsï¼ˆçµ±åˆãƒ†ã‚¹ãƒˆï¼‰

**å ´æ‰€**: `__tests__/integration/`  
**å¯¾è±¡**: API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã€TaskMaster API
**ãƒ„ãƒ¼ãƒ«**: Jest, Supertest

```typescript
// __tests__/integration/api/accounts.test.ts
describe("/api/accounts", () => {
  let app: NextApiHandler;
  let testDb: PrismaClient;

  beforeAll(async () => {
    // ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™
    testDb = new PrismaClient({
      datasources: { db: { url: process.env.TEST_DATABASE_URL } },
    });
    await testDb.$connect();
  });

  afterAll(async () => {
    await testDb.$disconnect();
  });

  beforeEach(async () => {
    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–
    await testDb.account.deleteMany();
  });

  describe("POST /api/accounts", () => {
    it("å‹˜å®šç§‘ç›®ã‚’ä½œæˆã§ãã‚‹ã“ã¨", async () => {
      const accountData = {
        accountCode: "TEST001",
        accountName: "ãƒ†ã‚¹ãƒˆå‹˜å®šç§‘ç›®",
        accountType: "è³‡ç”£",
        isDetail: true,
        isActive: true,
        sortOrder: 1,
      };

      const response = await request(app)
        .post("/api/accounts")
        .send(accountData)
        .expect(201);

      expect(response.body).toMatchObject(accountData);

      // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
      const saved = await testDb.account.findUnique({
        where: { accountCode: "TEST001" },
      });
      expect(saved).toBeTruthy();
    });
  });
});
```

#### E2E Testsï¼ˆEnd-to-End ãƒ†ã‚¹ãƒˆï¼‰

**å ´æ‰€**: `__tests__/e2e/`  
**å¯¾è±¡**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼å…¨ä½“ã€TaskMaster é€£æºãƒ•ãƒ­ãƒ¼
**ãƒ„ãƒ¼ãƒ«**: Playwright

```typescript
// __tests__/e2e/account-management.spec.ts
import { test, expect } from "@playwright/test";

test.describe("å‹˜å®šç§‘ç›®ç®¡ç†", () => {
  test("å‹˜å®šç§‘ç›®ã®ä½œæˆã‹ã‚‰å‰Šé™¤ã¾ã§ã®ãƒ•ãƒ­ãƒ¼", async ({ page }) => {
    // ãƒ­ã‚°ã‚¤ãƒ³
    await page.goto("/login");
    await page.fill("[data-testid=email]", "test@example.com");
    await page.fill("[data-testid=password]", "password");
    await page.click("[data-testid=login-button]");

    // å‹˜å®šç§‘ç›®ç®¡ç†ç”»é¢ã«é·ç§»
    await page.goto("/master/accounts");
    await expect(page).toHaveTitle(/å‹˜å®šç§‘ç›®ç®¡ç†/);

    // æ–°è¦ä½œæˆ
    await page.click("[data-testid=add-account-button]");
    await page.fill("[data-testid=account-code]", "TEST001");
    await page.fill("[data-testid=account-name]", "ãƒ†ã‚¹ãƒˆå‹˜å®šç§‘ç›®");
    await page.selectOption("[data-testid=account-type]", "è³‡ç”£");
    await page.click("[data-testid=save-button]");

    // ä½œæˆç¢ºèª
    await expect(page.locator("[data-testid=success-message]")).toBeVisible();
    await expect(page.locator("text=TEST001")).toBeVisible();

    // ç·¨é›†
    await page.click("[data-testid=edit-TEST001]");
    await page.fill("[data-testid=account-name]", "ãƒ†ã‚¹ãƒˆå‹˜å®šç§‘ç›®ï¼ˆæ›´æ–°ï¼‰");
    await page.click("[data-testid=save-button]");

    // æ›´æ–°ç¢ºèª
    await expect(page.locator("text=ãƒ†ã‚¹ãƒˆå‹˜å®šç§‘ç›®ï¼ˆæ›´æ–°ï¼‰")).toBeVisible();

    // å‰Šé™¤
    await page.click("[data-testid=delete-TEST001]");
    await page.click("[data-testid=confirm-delete]");

    // å‰Šé™¤ç¢ºèª
    await expect(page.locator("text=TEST001")).not.toBeVisible();
  });
});
```

#### TaskMaster E2E ãƒ†ã‚¹ãƒˆ

```typescript
// __tests__/e2e/taskmaster-workflow.spec.ts
import { test, expect } from "@playwright/test";

test.describe("TaskMasterçµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼", () => {
  test("æ–°æ©Ÿèƒ½é–‹ç™ºã®å®Œå…¨ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼", async ({ page }) => {
    // TaskMasterãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    await page.goto("/taskmaster");

    // æ–°ã‚¿ã‚¹ã‚¯ä½œæˆ
    await page.click("[data-testid=add-task-button]");
    await page.fill("[data-testid=task-prompt]", "æ–°ã—ã„å¸³ç¥¨æ©Ÿèƒ½ã®å®Ÿè£…");
    await page.check("[data-testid=research-enabled]");
    await page.click("[data-testid=create-task]");

    // ã‚¿ã‚¹ã‚¯åˆ†è§£
    const taskId = await page.textContent("[data-testid=new-task-id]");
    await page.click(`[data-testid=expand-${taskId}]`);
    await page.check("[data-testid=force-expand]");
    await page.click("[data-testid=expand-button]");

    // ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã®ç¢ºèª
    await expect(page.locator("[data-testid=subtasks]")).toBeVisible();

    // å®Ÿè£…é€²æ—ã®è¨˜éŒ²
    await page.click("[data-testid=first-subtask]");
    await page.fill("[data-testid=progress-notes]", "å®Ÿè£…é–‹å§‹ã—ã¾ã—ãŸ...");
    await page.click("[data-testid=update-subtask]");

    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
    await page.selectOption("[data-testid=status-select]", "done");
    await page.click("[data-testid=update-status]");

    expect(await page.textContent("[data-testid=task-status]")).toBe("done");
  });
});
```

### 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

#### åŸºæœ¬ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ã¿
npm run test:unit

# çµ±åˆãƒ†ã‚¹ãƒˆã®ã¿
npm run test:integration

# E2Eãƒ†ã‚¹ãƒˆã®ã¿
npm run test:e2e
```

#### TaskMaster çµ±åˆãƒ†ã‚¹ãƒˆ

```bash
# TaskMasteræ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
npm run test:taskmaster

# TaskMasterçµ±åˆãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
npm run test:taskmaster:e2e

# TaskMasterè¨­å®šã®æ¤œè¨¼
task-master validate-dependencies
```

#### é«˜åº¦ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
npm run test:coverage

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
npm run test:watch

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
npm run test:debug

# ä¸¦åˆ—å®Ÿè¡Œ
npm run test:parallel
```

### 4. CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

#### GitHub Actions è¨­å®š

```yaml
# .github/workflows/test.yml
name: Test Suite

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest

    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: biz_clone_test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: Install dependencies
        run: npm ci

      - name: Install TaskMaster
        run: npm install -g task-master-ai

      - name: Setup TaskMaster
        run: |
          task-master models --set-main=gpt-4o
          task-master models --set-research=perplexity-llama-3.1-sonar-small-128k-online
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          PERPLEXITY_API_KEY: ${{ secrets.PERPLEXITY_API_KEY }}

      - name: Setup Database
        run: |
          npx prisma generate
          npx prisma migrate deploy
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/biz_clone_test

      - name: Run Unit Tests
        run: npm run test:unit

      - name: Run Integration Tests
        run: npm run test:integration
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/biz_clone_test

      - name: Run TaskMaster Tests
        run: npm run test:taskmaster
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          PERPLEXITY_API_KEY: ${{ secrets.PERPLEXITY_API_KEY }}

      - name: Install Playwright
        run: npx playwright install

      - name: Run E2E Tests
        run: npm run test:e2e
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/biz_clone_test

      - name: Upload Test Results
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: test-results
          path: test-results/
```

## é–‹ç™ºãƒ„ãƒ¼ãƒ«çµ±åˆ

### 1. ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®š

#### Cursor IDEï¼ˆæ¨å¥¨ï¼‰

```json
// .cursor/settings.json
{
  "taskmaster.enabled": true,
  "taskmaster.mcp.enabled": true,
  "taskmaster.autoUpdate": true,
  "taskmaster.showProgress": true,
  "typescript.preferences.includePackageJsonAutoImports": "on",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true,
    "source.organizeImports": true
  },
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode"
}
```

#### VS Code è¨­å®š

```json
// .vscode/settings.json
{
  "typescript.preferences.includePackageJsonAutoImports": "on",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true,
    "source.organizeImports": true
  },
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "taskmaster.integration.enabled": true
}
```

#### æ¨å¥¨æ‹¡å¼µæ©Ÿèƒ½

```json
// .vscode/extensions.json
{
  "recommendations": [
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "ms-playwright.playwright",
    "prisma.prisma",
    "taskmaster.vscode-extension"
  ]
}
```

### 2. ãƒ‡ãƒãƒƒã‚°è¨­å®š

#### Launch.json è¨­å®š

```json
// .vscode/launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Next.js: debug server-side",
      "type": "node",
      "request": "attach",
      "port": 9229,
      "skipFiles": ["<node_internals>/**"]
    },
    {
      "name": "Next.js: debug client-side",
      "type": "chrome",
      "request": "launch",
      "url": "http://localhost:3000"
    },
    {
      "name": "TaskMaster Debug",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/node_modules/.bin/task-master",
      "args": ["list"],
      "env": {
        "TASKMASTER_LOG_LEVEL": "debug"
      }
    }
  ]
}
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. é–‹ç™ºç’°å¢ƒã®æœ€é©åŒ–

#### Next.js æœ€é©åŒ–

```javascript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    optimizePackageImports: ["@radix-ui/react-icons"],
    turbo: {
      rules: {
        "*.svg": {
          loaders: ["@svgr/webpack"],
          as: "*.js",
        },
      },
    },
  },
  // é–‹ç™ºæ™‚ã®ãƒãƒ³ãƒ‰ãƒ«æœ€é©åŒ–
  webpack: (config, { dev, isServer }) => {
    if (dev && !isServer) {
      config.optimization.splitChunks = {
        chunks: "all",
        cacheGroups: {
          vendor: {
            test: /[\\/]node_modules[\\/]/,
            name: "vendors",
            chunks: "all",
          },
        },
      };
    }
    return config;
  },
};

module.exports = nextConfig;
```

#### TaskMaster æœ€é©åŒ–

```bash
# TaskMaster ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ï¼ˆå‹•ä½œãŒé‡ã„å ´åˆï¼‰
task-master --clear-cache

# è¤‡é›‘åº¦åˆ†æã®çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
task-master analyze-complexity --cache

# å¤§é‡ã‚¿ã‚¹ã‚¯ã®åŠ¹ç‡çš„ãªå‡¦ç†
task-master list --limit=50 --offset=0
```

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–

#### Prisma æœ€é©åŒ–

```javascript
// lib/database/prisma.ts
import { PrismaClient } from '@prisma/client';

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined;
};

export const prisma = globalForPrisma.prisma ?? new PrismaClient({
  log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],
  // é–‹ç™ºç’°å¢ƒã§ã®ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«æœ€é©åŒ–
  datasources: {
    db: {
      url: process.env.DATABASE_URL,
    },
  },
});

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### 1. ä¸€èˆ¬çš„ãªå•é¡Œã¨è§£æ±ºç­–

#### TaskMaster é–¢é€£

```bash
# TaskMasterãŒèªè­˜ã•ã‚Œãªã„
npm install -g task-master-ai
task-master --version

# API ã‚­ãƒ¼ã‚¨ãƒ©ãƒ¼
task-master models --setup
# ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
echo $OPENAI_API_KEY

# ã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã®ç ´æ
task-master validate-dependencies
task-master fix-dependencies

# MCPæ¥ç¶šã‚¨ãƒ©ãƒ¼ï¼ˆCursorä½¿ç”¨æ™‚ï¼‰
# Cursorã‚’å†èµ·å‹•ã—ã€MCPè¨­å®šã‚’ç¢ºèª
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£

```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
npx prisma migrate reset --force
npx prisma migrate dev

# æ¥ç¶šã‚¨ãƒ©ãƒ¼
npx prisma db pull
npx prisma generate
```

#### Next.js é–¢é€£

```bash
# ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼
rm -rf .next
npm run build

# å‹ã‚¨ãƒ©ãƒ¼
npx tsc --noEmit
```

### 2. ãƒ­ã‚°ç¢ºèªã¨ãƒ‡ãƒãƒƒã‚°

#### TaskMaster ãƒ­ã‚°

```bash
# ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã®æœ‰åŠ¹åŒ–
export TASKMASTER_LOG_LEVEL=debug
task-master list

# ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
tail -f .taskmaster/logs/taskmaster.log
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«èª¿æ•´
export DEBUG=true
export LOG_LEVEL=debug
npm run dev
```

### 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ

#### é‡ã„ã‚¿ã‚¹ã‚¯å‡¦ç†

```bash
# ã‚¿ã‚¹ã‚¯ã‚’å°ã•ã„å˜ä½ã«åˆ†è§£
task-master expand --id=<heavy-task-id> --num=10 --force

# è¤‡é›‘åº¦åˆ†æã§é‡ã„ã‚¿ã‚¹ã‚¯ã‚’ç‰¹å®š
task-master analyze-complexity --threshold=8
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã®æœ€é©åŒ–

```typescript
// Prismaã‚¯ã‚¨ãƒªã®æœ€é©åŒ–ä¾‹
const accounts = await prisma.account.findMany({
  select: {
    id: true,
    accountCode: true,
    accountName: true,
    // å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿é¸æŠ
  },
  where: {
    isActive: true,
  },
  orderBy: {
    sortOrder: "asc",
  },
  take: 100, // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
});
```

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜       | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å†…å®¹                                         |
| ---------- | ---------- | -------------------------------------------- |
| 2025-01-21 | 2.0.0      | TaskMaster çµ±åˆã€AI æ”¯æ´é–‹ç™ºç’°å¢ƒæ§‹ç¯‰æ‰‹é †è¿½åŠ  |
| 2025-06-12 | 1.2.0      | å‹ã‚·ã‚¹ãƒ†ãƒ çµ±ä¸€å¯¾å¿œã€ãƒ†ã‚¹ãƒˆæˆ¦ç•¥å¼·åŒ–           |
| 2025-01-09 | 1.0.0      | åˆç‰ˆä½œæˆ                                     |

---

ğŸ“š **Note**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ TaskMaster ã«ã‚ˆã‚‹ AI æ”¯æ´é–‹ç™ºæ‰‹æ³•ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚å¾“æ¥ã®æ‰‹å‹•é–‹ç™ºæ‰‹æ³•ã¨ã®é•ã„ã‚’ç†è§£ã—ã€åŠ¹ç‡çš„ãªé–‹ç™ºç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
